import{_ as A,c as _,a as r,t as y,f as T,b as D,F as L,e as P,g as m,o as C,n as W,h as B,p as R,i as j,r as O}from"./index-qMM8V2hf.js";var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E={exports:{}};(function(t,e){(function(l,f){f()})(w,function(){function l(n,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function f(n,o,u){var a=new XMLHttpRequest;a.open("GET",n),a.responseType="blob",a.onload=function(){v(a.response,o,u)},a.onerror=function(){console.error("could not download file")},a.send()}function h(n){var o=new XMLHttpRequest;o.open("HEAD",n,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function s(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof w=="object"&&w.global===w?w:void 0,i=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(n,o,u){var a=d.URL||d.webkitURL,c=document.createElement("a");o=o||n.name||"download",c.download=o,c.rel="noopener",typeof n=="string"?(c.href=n,c.origin===location.origin?s(c):h(c.href)?f(n,o,u):s(c,c.target="_blank")):(c.href=a.createObjectURL(n),setTimeout(function(){a.revokeObjectURL(c.href)},4e4),setTimeout(function(){s(c)},0))}:"msSaveOrOpenBlob"in navigator?function(n,o,u){if(o=o||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(l(n,u),o);else if(h(n))f(n,o,u);else{var a=document.createElement("a");a.href=n,a.target="_blank",setTimeout(function(){s(a)})}}:function(n,o,u,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),typeof n=="string")return f(n,o,u);var c=n.type==="application/octet-stream",S=/constructor/i.test(d.HTMLElement)||d.safari,k=/CriOS\/[\d]+/.test(navigator.userAgent);if((k||c&&S||i)&&typeof FileReader<"u"){var b=new FileReader;b.onloadend=function(){var g=b.result;g=k?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=g:location=g,a=null},b.readAsDataURL(n)}else{var F=d.URL||d.webkitURL,x=F.createObjectURL(n);a?a.location=x:location.href=x,a=null,setTimeout(function(){F.revokeObjectURL(x)},4e4)}});d.saveAs=v.saveAs=v,t.exports=v})})(E);var X=E.exports;const M="/DAO_Taiwan_Vue/assets/logo_small-n2mYl6OL.png",Y="/DAO_Taiwan_Vue/assets/conbon_c-bm_N2DFX.png",U={data(){return{selectedProduct:null,message:" ",painting:!1,canvas:null,ctx:null,colors:["#C73232","#E6A34B","#EBC352","#FDF673","#D4DAAC","#9BEC58","#4234E9","#A0BEBA","#DDE9F1","#D59CF9"],currentColor:"#C73232",backgroundColor:"#FFFFFF",appWidth:0,lastX:0,lastY:0}},computed:{canvasWidth(){return this.appWidth}},methods:{updateAppWidth(){this.appWidth=this.$refs.appContainer.offsetWidth},changeColor(t){this.ctx.strokeStyle=t,this.currentColor=t,this.eraser(!1)},clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.backgroundColor="#FFFFFF",this.eraser(!1)},fillCanvas(){this.ctx.fillStyle=this.currentColor,this.backgroundColor=this.currentColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)},startPainting(t){this.painting=!0,t.touches&&t.touches.length>0?this.touchStart(t.touches[0]):this.draw(t)},draw(t){if(!this.painting)return;const e=t.offsetX||t.touches[0].clientX-this.$refs.canvas.offsetLeft,l=t.offsetY||t.touches[0].clientY-this.$refs.canvas.offsetTop;this.ctx.lineWidth=10,this.ctx.lineCap="round",this.ctx.lineTo(e,l),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(e,l)},paintingSelect(){this.ctx.strokeStyle=this.currentColor},finishedPainting(){this.painting=!1,this.ctx.beginPath()},startTouching(t){t.preventDefault(),this.painting=!0;const e=t.touches[0].clientX,l=t.touches[0].clientY;this.lastX=e,this.lastY=l},dragging(t){t.preventDefault();const e=t.touches[0].clientX,l=t.touches[0].clientY;this.painting&&(this.ctx.lineWidth=10,this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(e,l),this.ctx.stroke(),this.lastX=e,this.lastY=l)},finishDragging(){this.painting=!1,this.ctx.beginPath()},eraser(t){t?this.ctx.strokeStyle="#FFFFFF":this.ctx.strokeStyle=this.currentColor},saveCanvas(){const t=document.createElement("canvas"),e=t.getContext("2d"),l=1024,f=1024;t.width=l,t.height=f,e.drawImage(this.canvas,0,0,l,f),t.toBlob(h=>{X.saveAs(h,"canvas_image.png")},"image/png")}},mounted(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.updateAppWidth(),window.addEventListener("resize",this.updateAppWidth),this.canvas.height=window.innerWidth*.9,this.canvas.width=576,this.ctx.strokeStyle=this.colors[0];const t=JSON.parse(localStorage.getItem("selectedProduct"));t&&(this.selectedProduct=t)},beforeUnmount(){window.removeEventListener("resize",this.updateAppWidth)},updated(){this.updateAppWidth()}},p=t=>(R("data-v-e4e06faf"),t=t(),j(),t),I=p(()=>r("h1",null,"繪製貼圖",-1)),H={key:0},V={class:"my-0 mx-auto d-flex justify-content-between align-items-center"},N={href:"#",class:"button-circle"},z=p(()=>r("img",{class:"logo_sm",src:M,alt:"logo_sm"},null,-1)),q=p(()=>r("a",{class:"done-button",href:"#"},"完成",-1)),G={id:"app",class:"position-relative",ref:"appContainer"},J={class:"canvas-container"},K=["width","height"],Q=p(()=>r("img",{src:Y,class:"overlay-img",alt:"conbon_c"},null,-1)),Z={class:"color-picker"},$=["onClick"],tt={class:"tool-list d-flex"},et=p(()=>r("i",{class:"fas fa-paint-brush"},null,-1)),nt=[et],st=p(()=>r("i",{class:"fab fa-bitbucket"},null,-1)),it=[st],ot=p(()=>r("i",{class:"fas fa-eraser"},null,-1)),at=[ot],rt=p(()=>r("i",{class:"fas fa-trash"},null,-1)),lt=[rt],ct=p(()=>r("i",{class:"fas fa-save"},null,-1)),dt=[ct];function ht(t,e,l,f,h,s){const d=O("ion-icon");return C(),_("div",null,[I,h.selectedProduct?(C(),_("div",H,[r("h2",null,"選中的物件: "+y(h.selectedProduct.name),1),r("p",null,"物件描述: "+y(h.selectedProduct.description),1)])):T("",!0),r("nav",V,[r("a",N,[D(d,{name:"chevron-back-outline"})]),z,q]),r("div",G,[r("h2",null,y(h.message),1),r("div",J,[r("canvas",{onMousedown:e[0]||(e[0]=(...i)=>s.startPainting&&s.startPainting(...i)),onMouseup:e[1]||(e[1]=(...i)=>s.finishedPainting&&s.finishedPainting(...i)),onMousemove:e[2]||(e[2]=(...i)=>s.draw&&s.draw(...i)),onTouchstart:e[3]||(e[3]=(...i)=>s.startTouching&&s.startTouching(...i)),onTouchmove:e[4]||(e[4]=(...i)=>s.dragging&&s.dragging(...i)),onTouchend:e[5]||(e[5]=(...i)=>s.finishDragging&&s.finishDragging(...i)),id:"canvas",width:s.canvasWidth,height:s.canvasWidth},null,40,K),Q]),r("div",Z,[(C(!0),_(L,null,P(h.colors,i=>(C(),_("div",{key:i},[r("div",{class:W(["color-box",{currentColor:i===this.currentColor}]),style:B({backgroundColor:i,outlineColor:i}),onClick:v=>s.changeColor(i)},null,14,$)]))),128))]),r("div",tt,[r("a",{class:"painting-button",onClick:e[6]||(e[6]=m((...i)=>s.paintingSelect&&s.paintingSelect(...i),["prevent"]))},nt),r("a",{class:"fill-button",onClick:e[7]||(e[7]=m((...i)=>s.fillCanvas&&s.fillCanvas(...i),["prevent"]))},it),r("a",{class:"eraser-button",onClick:e[8]||(e[8]=m(i=>s.eraser(!0),["prevent"]))},at),r("a",{class:"clear-button",onClick:e[9]||(e[9]=m((...i)=>s.clearCanvas&&s.clearCanvas(...i),["prevent"]))},lt),r("a",{class:"save-button",onClick:e[10]||(e[10]=m((...i)=>s.saveCanvas&&s.saveCanvas(...i),["prevent"]))},dt)])],512)])}const ft=A(U,[["render",ht],["__scopeId","data-v-e4e06faf"]]);export{ft as default};
