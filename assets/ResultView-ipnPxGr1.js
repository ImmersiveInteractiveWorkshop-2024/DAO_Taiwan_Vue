import{io as m}from"https://cdn.socket.io/4.7.5/socket.io.esm.min.js";import{_ as p,c as d,a as s,f as r,b as h,w as u,h as C,d as i,F as f,r as b,o as w,p as k,e as v}from"./index-LSF1mwtH.js";const I="/assets/logo_white-AiIJoPJw.png",D="/assets/streetlight-La1yFIpG.png",x="/assets/toggle-light-Mn1Hd3bC.png",y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAnCAYAAACfdBHBAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAPqSURBVFhHvVhLUhsxEGXAsA05AeYEgRNg7yjbVMwFApwAWGUJnCBwgtgnwJSBYoe5QAInyHCCmGwBO++ppKm2rPlrUJVrxrbU/fqpf1KwkHNsb2/Xa7XaXhAEq9PpdAPLV/HO5wK+P+J9hNfR0tLSw2AwGOcUn2t6kHV2u90m4H18GlnX0BjM7V1fX19kXZNnXir4TqfTAOBLMpxHsJyrjTiGEdwVbyMRPICfAPipQ1t/MpnQRR7xHN/e3pLhBRqKB43lc8ux7hzudObLnZzgtV9fGl/W/vwMBs+Xl5d7WZR3u93V9/f3LtdAzidhSPj6+tq8u7sLy27BHHit9I/lJldgbD8LaBuQltfD71/Nf3QjBH2ziDwpfw48tv5eBiXc4vjm5ua8LEs7OzvchZ7ZBbyPEAPNMnJnwCOjHC0uLv4QDDV9BhkM2IfsnwJwbzgcHhQ1IALfarU24Bq/BfAzAHcFa1Fdap1PgiLwYIV+XtfIHsAIM0YlA7oYA3sUXsZ9FHjJOoS9vL29bfjIBnGW6yD+a/5H9lkvok+Bl0zgax+s0zcrHRb7AwQya8BTngxkwJMFVUGRmzdN0akSva7c9y4ddCUYE+LZT0oYgRSCyU+YrJqsjxhgfwQ9rkocqachcOMDl1sFVvR/iMsYZDrWohoCoHUwvhZD3AHcmYEeDTJ/igUn/AWLK0mPeXeRRqHedLGOXaw0ZsaAwArWOevyKvY938JH8bvYgQFfCD7yOzDvtaKSQR/BbxkQAvy6AU8rTNMUWVWWQbgjW+YvkHMFZXSBUgPyQuFCykNsn79AtjkqpUUvBltTIweKUg89aTqtvkixb6fKR4DfTBOU5X/f4KlTss96ZIpUxFLRUm0bVAV46fts1Q146fdeMk4V4O20rsDLQlWmy5PsVwGeBxro4GWAqkkKvD6zMjuos6aP01MV4J3M2+zj+xi+v1mkTTXsVwHeyve7MylM5OZShwQa4Bu8fTGA9vnzDHjHUTC24lIYur1DfPquHUoDr/uXLdwi9LP08CCWVyiHemdVA+m6PVCNGk9UEFyPEyx2aYyc27TbgCTwVsFJ7WTtg7tJ587KR1ZWVlbCJEascj1nQBx4xw1CYvtgz5edb+GyrbedJx5zGzZjgAu8A8gTdrcRR5LD0Af4etfMLwyevpdkgA0+L3Ad9D081S0Dxpx7lQKfZIC8A8I8XixFl008biYxbtKtuSrE/NDVMJYGH2cAfndeiWcFLqt13LsX8DEGzOn0CZzCvYFPM8A3cO/g4wyoAngl4IUBv5BGAwD/h+Bcy1JFs/i5nOPVbaRgdKotgP6GDvU7qu9zXmBZ5v8HKDWkCJ3bDL0AAAAASUVORK5CYII=",L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAO3SURBVFhH7VmxbhpBEM0Z3FiRQrp0cdo0IV2KSLl0Ftgy+QLjLzB8QfAXGHfpQpq0xsJGpjL+ApPeUkiXLqS2gbx33kXLcrcsy3KOopyEz9zNzrx9Ozs7MwSPDNfW1tZmNpvdhUiIT46fIAjypjEO7wbj8bgHvb3hcPil3W73knQEcS8EyCMoKDkYX2oIgHeh4PDs7Iz3qWsG7M7OzhEkKktZ9DO43mq1qqqqKbAA+hkvy6oAZvobDHflUuE+8IPlXgt0b0InXauE/59ruhsAvC+fTcDqQKHgBwbXINzwCc6kCxjKsFuH3SdSbjQaVc/Pz+vRxPhne3s7hMClougqk8mUms2mVxZtJl0qlXJ3d3dd4Hkl5W9vb19cXFz0JdhLvAz5EjP7Buf2veNtcE5kxAZnhIgYBqZjYKoEhUIhDxavpSRevI/bibo1jsMSDTjjhZBYCmO1awD7UYgP4I5Pg2KxWFlbW2MEmMuqWKIDKGG0YNzl1aefYYLHljisxMju+vr6d8V3XwZw6iYeMPATLONbLUkbZsulmfiSJje1c60QzRFS7eHA2A/w4Fo5lT6AboKfubRlSTKz7zN6qEQC7AGZHdv4K8AO1JASh5axGCvz2ger1KESBN2frMDq/mMCA2Zjj3CXCWhgv/57YMWS9GOOQ52wUzDrLflxYlb3n6QltY3Rti7hDJYGsBkbuO0lbC5j2LMFqMotBVYALuPOhCM6kkVGxkOh6wLINGZpsL4B/QebJqPS1l/rBkio9pBQhdgLmwDbRUZ3iu+sHqLMC8/tDoVVsioyuROZT2u2+vhO8Pdg1czGd5ycN0mRS59IQCZ5ySxDzjuB3irxngfC5j1iNk86FqgyLzYOezCwLAwFUJt5RTIPAjau3LdBnDpYV6BLMQuju/K4ZYgx9adoSOx4VtDOVfPCzIr+AjdFFE6Uq44K+TCuz+ADaCyzeBhbQ9EgaiAG58QeGEsavK+qCY0I9OymWO34RUPXTJpnYDNRNzuBCUHeZi/FysS5QdT5kH42j01nyw4D5Qmmdj6uUJaELmw62F9oiCzFeZLwyJPBl+BrC2lKQRhg3wRi8/xKwZ6zCfaI4Z65qMY31VbOFjwOlG2tCOwiTQyPGKxUkVX0a/OT/ixHqd1EKy3pCU36b/pvCg1giC2108M2ZWnqkJrpS5FhRoN5TbhVgufvGdBf1sv7xN/B0Mhl+EqVZYJkY1r+4KETYuz4hWH4eGNj4y0KN2ZLz1bE5g1i6E9kb71Op3NjsvEH3WCi9/WLzV8AAAAASUVORK5CYII=";const a=m("https://daotaiwanapi.onrender.com",{withCredentials:!1}),U={data(){return{resultDataReady:!1,resultImageGet:!1,resultData:null,textureCookie:null,textureId:null,lightMode:!1,message:null,intro:!0}},methods:{toggleDarkMode(){document.querySelector(".app").classList.toggle("active"),this.lightMode=!this.lightMode;const e=document.querySelector(".toggle-switch");e.classList.toggle("active"),document.querySelector(".toggle-light").classList.toggle("active"),this.intro&&(document.querySelector(".overlay").classList.toggle("active"),this.intro=!1),console.log(this.textureId),(this.resultImageGet!=null||this.textureId!=null)&&(e.classList.contains("active")?this.lightControllById(this.textureId,this.resultData.category,"light-on"):this.lightControllById(this.textureId,this.resultData.category,"light-off"))},lightControllById(t,e,o){try{a.emit(o,{_id:t,category:e})}catch(A){console.error("開關燈失敗:",A)}},fetchResultImage(t){fetch(`https://daotaiwanapi.onrender.com/results/${t}`,{method:"GET"}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{console.log(e),this.resultData=e.data[0],this.resultImageGet=!0,console.log(this.resultData.url)}).catch(e=>{console.error("Error:",e)})},downloadImage(){if(this.resultData){const t=document.createElement("a");t.href=this.resultData.url,console.log(t.href),t.download="DAO-Taiwan-result-image.png",fetch(t.href,{mode:"cors"}).then(e=>e.blob()).then(e=>{const o=window.URL.createObjectURL(e);t.href=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(o)}).catch(e=>{console.error("Error downloading image:",e)})}}},created(){a.on("result-upload",t=>{console.log("伺服器傳送訊息:",t),console.log(this.textureId,t._id),t!=null&&this.textureId===t._id&&(this.fetchResultImage(this.textureId),this.resultData=t)}),a.on("light-on",t=>{console.log("伺服器傳送訊息:",t)}),a.on("light-off",t=>{console.log("伺服器傳送訊息:",t)})},mounted(){const t=document.cookie.split(";");for(let e=0;e<t.length;e++){const o=t[e].trim().split("=");if(o[0]==="textureCookie"){this.textureCookie=JSON.parse(o[1]),this.textureId=this.textureCookie._id,console.log(this.textureId),this.fetchResultImage(this.textureId);break}}}},l=t=>(k("data-v-1721de55"),t=t(),v(),t),B=l(()=>s("h1",{class:"d-none"},"結果頁面",-1)),V={id:"app",class:"position-relative app",ref:"appContainer"},R={class:"my-0 mx-auto d-flex justify-content-between align-items-center"},z=l(()=>s("img",{class:"logo_white mx-auto pt-3",src:I,alt:"logo_white"},null,-1)),H={class:"w-25 d-flex d-none"},O={class:"position-relative"},S=l(()=>s("img",{class:"streetlight",src:D,alt:"streetlight"},null,-1)),Z=l(()=>s("img",{src:x,alt:"toggle-light",class:"streetlight toggle-light"},null,-1)),_=["src"],K=l(()=>s("div",{class:"overlay"},[i("點選按鈕照亮您的招牌"),s("br"),i("試著在場景中找到他吧！！")],-1)),j={class:"d-flex flex-column justify-content-between h-100 pb-5 pt-2 result-content"},q=l(()=>s("div",{class:"toggle-handle"},null,-1)),E=[q],Y=l(()=>s("p",{class:"result-text pt-3 d-none"},[i("點選按鈕照亮您的招牌"),s("br"),i("試著在場景中找到他吧！！")],-1)),G={class:"d-flex justify-content-between buttons"},M=l(()=>s("img",{src:y,alt:""},null,-1)),Q=l(()=>s("img",{src:L,alt:""},null,-1));function P(t,e,o,A,J,n){const g=b("router-link");return w(),d(f,null,[B,s("div",V,[s("nav",R,[z,r("",!0),s("div",H,[h(g,{class:"done-button",to:"/home"},{default:u(()=>[i("家")]),_:1})])]),s("div",O,[S,Z,this.resultData?(w(),d("img",{key:0,src:this.resultData.url,class:"result-image position-relative",alt:"result-image"},null,8,_)):r("",!0),K]),s("div",j,[s("div",{class:"toggle-switch mx-auto",onClick:e[0]||(e[0]=(...c)=>n.toggleDarkMode&&n.toggleDarkMode(...c))},E),Y,s("div",G,[s("a",{class:"upload-button",href:"#",onClick:e[1]||(e[1]=C((...c)=>n.downloadImage&&n.downloadImage(...c),["prevent"]))},[M,r("",!0),i(" 下載街景")]),h(g,{class:"upload-button",to:"/gallery"},{default:u(()=>[Q,r("",!0),i(" 大家ㄉ庫")]),_:1})])])],512)],64)}const X=p(U,[["render",P],["__scopeId","data-v-1721de55"]]);export{X as default};
